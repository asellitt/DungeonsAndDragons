---
layout: card
title: Card Generator (Pathfinder)
---

<html>
    <head>
        <style>
            @media print {
                .class-picker {
                    display: none !important;
                }

                .no-print {
                    display: none !important;
                }
            }

            @font-face {
                font-family: "Pathfinder-Icons";
                src: url("../assets/fonts/Pathfinder-Icons.ttf");
            }

            @font-face {
                font-family: "ActionIcons";
                src: url("../assets/fonts/action_icons.eot");
                src: url("../assets/fonts/action_icons.woff2") format("woff2"),
                    url("../assets/fonts/action_icons.woff") format("woff"),
                    url("../assets/fonts/action_icons.ttf") format("truetype");
                font-weight: normal;
                font-style: normal;
            }

            strong p {
                /* api has some fucked data... */
                font-weight: initial;
            }

            .no-print {
                filter: opacity(0.2);
            }

            .class-picker {
                display: flex;
                justify-content: center;
            }

            .card-wrapper {
                display: inline-block;
            }

            .card-wrapper .class-artificer {
                background-color: #d59139;
            }
            .card-wrapper .class-artificer hr {
                border-bottom: 1.5px solid #d59139;
            }
            .card-wrapper .class-artificer .header {
                color: #d59139;
            }

            .card-wrapper .class-barbarian {
                background-color: #e5623e;
            }
            .card-wrapper .class-barbarian hr {
                border-bottom: 1.5px solid #e5623e;
            }
            .card-wrapper .class-barbarian .header {
                color: #e5623e;
            }

            .card-wrapper .class-bard {
                background-color: #aa6dab;
            }
            .card-wrapper .class-bard hr {
                border-bottom: 1.5px solid #aa6dab;
            }
            .card-wrapper .class-bard .header {
                color: #aa6dab;
            }

            .card-wrapper .class-cleric {
                background-color: #92a2b3;
            }
            .card-wrapper .class-cleric hr {
                border-bottom: 1.5px solid #92a2b3;
            }
            .card-wrapper .class-cleric .header {
                color: #92a2b3;
            }

            .card-wrapper .class-druid {
                background-color: #79853c;
            }
            .card-wrapper .class-druid hr {
                border-bottom: 1.5px solid #79853c;
            }
            .card-wrapper .class-druid .header {
                color: #79853c;
            }

            .card-wrapper .class-fighter {
                background-color: #7e4f3d;
            }
            .card-wrapper .class-fighter hr {
                border-bottom: 1.5px solid #7e4f3d;
            }
            .card-wrapper .class-fighter .header {
                color: #7e4f3d;
            }

            .card-wrapper .class-fighter {
                background-color: #7e4f3d;
            }
            .card-wrapper .class-fighter hr {
                border-bottom: 1.5px solid #7e4f3d;
            }
            .card-wrapper .class-fighter .header {
                color: #7e4f3d;
            }

            .card-wrapper .class-monk {
                background-color: #53a5c5;
            }
            .card-wrapper .class-monk hr {
                border-bottom: 1.5px solid #53a5c5;
            }
            .card-wrapper .class-monk .header {
                color: #53a5c5;
            }

            .card-wrapper .class-paladin {
                background-color: #b59e54;
            }
            .card-wrapper .class-paladin hr {
                border-bottom: 1.5px solid #b59e54;
            }
            .card-wrapper .class-paladin .header {
                color: #b59e54;
            }

            .card-wrapper .class-ranger {
                background-color: #4f7e61;
            }
            .card-wrapper .class-ranger hr {
                border-bottom: 1.5px solid #4f7e61;
            }
            .card-wrapper .class-ranger .header {
                color: #4f7e61;
            }

            .card-wrapper .class-rogue {
                background-color: #555752;
            }
            .card-wrapper .class-rogue hr {
                border-bottom: 1.5px solid #555752;
            }
            .card-wrapper .class-rogue .header {
                color: #555752;
            }

            .card-wrapper .class-sorcerer {
                background-color: #972e2e;
            }
            .card-wrapper .class-sorcerer hr {
                border-bottom: 1.5px solid #972e2e;
            }
            .card-wrapper .class-sorcerer .header {
                color: #972e2e;
            }

            .card-wrapper .class-warlock {
                background-color: #8137af;
            }
            .card-wrapper .class-warlock hr {
                border-bottom: 1.5px solid #8137af;
            }
            .card-wrapper .class-warlock .header {
                color: #8137af;
            }

            .card-wrapper .class-wizard {
                background-color: #0045b7;
            }
            .card-wrapper .class-wizard hr {
                border-bottom: 1.5px solid #0045b7;
            }
            .card-wrapper .class-wizard .header {
                color: #0045b7;
            }

            .card-wrapper .gf9-arcane {
                background-color: #cd503f;
            }
            .card-wrapper .gf9-arcane hr {
                border-bottom: 1.5px solid #cd503f;
            }
            .card-wrapper .gf9-arcane .header {
                color: #cd503f;
            }

            .card-wrapper .gf9-bard {
                background-color: #923674;
            }
            .card-wrapper .gf9-bard hr {
                border-bottom: 1.5px solid #923674;
            }
            .card-wrapper .gf9-bard .header {
                color: #923674;
            }

            .card-wrapper .gf9-cleric {
                background-color: #e2af18;
            }
            .card-wrapper .gf9-cleric hr {
                border-bottom: 1.5px solid #e2af18;
            }
            .card-wrapper .gf9-cleric .header {
                color: #e2af18;
            }

            .card-wrapper .gf9-druid {
                background-color: #77aa58;
            }
            .card-wrapper .gf9-druid hr {
                border-bottom: 1.5px solid #77aa58;
            }
            .card-wrapper .gf9-druid .header {
                color: #77aa58;
            }

            .card-wrapper .gf9-paladin {
                background-color: #41b3d1;
            }
            .card-wrapper .gf9-paladin hr {
                border-bottom: 1.5px solid #41b3d1;
            }
            .card-wrapper .gf9-paladin .header {
                color: #41b3d1;
            }

            .card-wrapper .gf9-ranger {
                background-color: #745e2a;
            }
            .card-wrapper .gf9-ranger hr {
                border-bottom: 1.5px solid #745e2a;
            }
            .card-wrapper .gf9-ranger .header {
                color: #745e2a;
            }

            .feat-card {
                display: inline-block;
                position: relative;
                width: 63mm;
                height: 89mm;
                padding: 0;
                margin: 5px;
                border-radius: 4.7619047619%;
                font-family: Helvetica Neue, Open Sans Condensed, sans-serif;
                font-weight: 400;
                font-size: 3mm;
                color: #111;
                text-align: center;
                overflow: hidden;
                background-color: #000;
            }
            .feat-card .action {
                font-family: "ActionIcons";
                font-weight: initial;
                text-transform: none;
            }
            .feat-card .action-action1:before {
                content: "\00E1";
            }
            .feat-card .action-action2:before {
                content: "\00E2";
            }
            .feat-card .action-action3:before {
                content: "\00E3";
            }
            .feat-card .action-free:before {
                content: "\00E0";
            }
            .feat-card .action-reaction:before {
                content: "\00E4";
            }
            .feat-card .name {
                background-color: #fff;
                position: absolute;
                top: 3mm;
                left: 3mm;
                width: 57mm;
                height: 5mm;
                border-radius: 2mm 2mm 0 0;
                display: flex;
                align-items: center;
                justify-content: center;
            }
            .feat-card .name .content {
                font-size: 3.5mm;
                text-transform: uppercase;
                font-weight: bold;
            }
            .feat-card .skill {
                position: absolute;
                top: 8mm;
                width: 100%;
                height: 3mm;
                text-transform: capitalize;
            }
            .feat-card .skill .content {
                color: #fff;
                font-size: 2mm;
                line-height: 3mm;
            }
            .feat-card .trait {
                background-color: #fff;
                text-align: center;
            }
            .feat-card .header {
                font-weight: bold;
                text-transform: uppercase;
                font-size: 3mm;
                color: #000;
            }
            .feat-card .description {
                background-color: #fff;
                display: inline-block;
                position: absolute;
                top: 11mm;
                left: 3mm;
                width: 55mm;
                padding: 1mm;
                padding-top: 0;
                text-align: justify;
                overflow: clip;
                font-size: 2.2mm;
                height: 74mm;
                border-radius: 0 0 2mm 2mm;
            }
            .feat-card .description p {
                margin: 0;
                padding-left: 0;
                border: 0;
                padding-bottom: 0.5mm;
            }
            .feat-card .description ul {
                margin: 0;
                padding-left: 2mm;
                border: 0;
                padding-bottom: 0.5mm;
            }
            .feat-card hr {
                margin: 0;
                border: 0;
                position: relative;
                left: -1mm;
                width: 57mm;
                border-bottom: 1.5px solid black;
            }
            .feat-card table {
                border-collapse: collapse;
                white-space: initial !important;
                text-align: left;
                vertical-align: top;
            }
            .feat-card table,
            .feat-card tr,
            .feat-card td,
            .feat-card th {
                vertical-align: top;
                padding: 0;
                margin: 0;
                border: 0;
            }
            .feat-card th:first-child,
            .feat-card td:first-child {
                padding-right: 1mm;
            }

            .spell-card {
                position: relative;
                width: 63mm;
                height: 89mm;
                padding: 0;
                margin: 5px;
                border-radius: 4.7619047619%;
                font-family: Helvetica Neue, Open Sans Condensed, sans-serif;
                font-weight: 400;
                font-size: 3mm;
                color: #111;
                text-align: center;
                overflow: hidden;
                background-color: #000;
            }
            .spell-card .action {
                font-family: "ActionIcons";
                font-weight: initial;
                text-transform: none;
            }
            .spell-card .action-action1:before {
                content: "\00E1";
            }
            .spell-card .action-action2:before {
                content: "\00E2";
            }
            .spell-card .action-action3:before {
                content: "\00E3";
            }
            .spell-card .action-free:before {
                content: "\00E0";
            }
            .spell-card .action-reaction:before {
                content: "\00E4";
            }
            .spell-card .name {
                background-color: #fff;
                position: absolute;
                top: 3mm;
                left: 3mm;
                width: 57mm;
                height: 5mm;
                border-radius: 2mm 2mm 0 0;
                display: flex;
                align-items: center;
                justify-content: center;
            }
            .spell-card .name .content {
                font-size: 3.5mm;
                text-transform: uppercase;
                font-weight: bold;
            }
            .spell-card .spell-level {
                position: absolute;
                top: 8mm;
                width: 100%;
                height: 3mm;
            }
            .spell-card .spell-level .content {
                color: #fff;
                font-size: 2mm;
                line-height: 3mm;
                text-transform: capitalize;
            }
            .spell-card .saving-throw,
            .spell-card .range {
                background-color: #fff;
                display: inline-block;
                position: absolute;
                top: 11mm;
                width: 28.25mm;
                height: 7.5mm;
                text-transform: capitalize;
            }
            .spell-card .saving-throw {
                left: 3mm;
                text-transform: capitalize;
            }
            .spell-card .range {
                left: 31.75mm;
                text-transform: capitalize;
            }
            .spell-card .components,
            .spell-card .duration {
                background-color: #fff;
                display: inline-block;
                position: absolute;
                top: 19mm;
                width: 28.25mm;
                height: 7.5mm;
                text-transform: capitalize;
            }
            .spell-card .components {
                left: 3mm;
            }
            .spell-card .duration {
                left: 31.75mm;
            }
            .spell-card .header {
                font-weight: bold;
                text-transform: uppercase;
                font-size: 3mm;
                color: #000;
            }
            .spell-card .description {
                background-color: #fff;
                display: inline-block;
                position: absolute;
                top: 27mm;
                left: 3mm;
                width: 55mm;
                padding: 1mm;
                padding-top: 0;
                text-align: justify;
                overflow: hidden;
                font-size: 2.2mm;
                height: 58mm;
                border-radius: 0 0 2mm 2mm;
            }
            .spell-card .description p {
                margin: 0;
                padding-left: 0;
                border: 0;
                padding-bottom: 0.5mm;
            }
            .spell-card .description ul {
                margin: 0;
                padding-left: 2mm;
                border: 0;
                padding-bottom: 0.5mm;
            }
            .spell-card hr {
                margin: 0;
                border: 0;
                position: relative;
                left: -1mm;
                width: 57mm;
                border-bottom: 1.5px solid black;
            }
            .feat-card table {
                border-collapse: collapse;
                white-space: initial !important;
                text-align: left;
                vertical-align: top;
            }
            .spell-card table,
            .spell-card tr,
            .spell-card td,
            .spell-card th {
                vertical-align: top;
                padding: 0;
                margin: 0;
                border: 0;
            }
            .spell-card th:first-child,
            .spell-card td:first-child {
                padding-right: 1mm;
            }
        </style>
    </head>
    <body>
        <div class="class-picker">
            <div>
                <div>
                    <input
                        type="text"
                        id="character-id"
                        placeholder="Pathbuilder2e character id"
                    />
                    <input
                        type="text"
                        id="api-key"
                        placeholder="Pathfinder2.fr api key"
                    />
                    <button id="fetch-data">Fetch</button>
                </div>
                <div>
                    <select id="feat-picker">
                        <option value="">Feat card colour</option>
                        <optgroup label="Class">
                            <option value="class-artificer">Artificer</option>
                            <option value="class-barbarian">Barbarian</option>
                            <option value="class-bard">Bard</option>
                            <option value="class-cleric">Cleric</option>
                            <option value="class-druid">Druid</option>
                            <option value="class-fighter">Fighter</option>
                            <option value="class-monk">Monk</option>
                            <option value="class-paladin">Paladin</option>
                            <option value="class-ranger">Ranger</option>
                            <option value="class-rogue">Rogue</option>
                            <option value="class-sorcerer">Sorcerer</option>
                            <option value="class-warlock">Warlock</option>
                            <option value="class-wizard">Wizard</option>
                        </optgroup>
                        <optgroup label="Gale Force Nine">
                            <option value="gf9-arcane">Arcane</option>
                            <option value="gf9-bard">Bard</option>
                            <option value="gf9-cleric">Cleric</option>
                            <option value="gf9-druid">Druid</option>
                            <option value="gf9-paladin">Paladin</option>
                            <option value="gf9-ranger">Ranger</option>
                        </optgroup>
                    </select>
                    <select id="spell-picker">
                        <option value="">Spell card colour</option>
                        <optgroup label="Class">
                            <option value="class-artificer">Artificer</option>
                            <option value="class-barbarian">Barbarian</option>
                            <option value="class-bard">Bard</option>
                            <option value="class-cleric">Cleric</option>
                            <option value="class-druid">Druid</option>
                            <option value="class-fighter">Fighter</option>
                            <option value="class-monk">Monk</option>
                            <option value="class-paladin">Paladin</option>
                            <option value="class-ranger">Ranger</option>
                            <option value="class-rogue">Rogue</option>
                            <option value="class-sorcerer">Sorcerer</option>
                            <option value="class-warlock">Warlock</option>
                            <option value="class-wizard">Wizard</option>
                        </optgroup>
                        <optgroup label="Gale Force Nine">
                            <option value="gf9-arcane">Arcane</option>
                            <option value="gf9-bard">Bard</option>
                            <option value="gf9-cleric">Cleric</option>
                            <option value="gf9-druid">Druid</option>
                            <option value="gf9-paladin">Paladin</option>
                            <option value="gf9-ranger">Ranger</option>
                        </optgroup>
                    </select>

                    <button id="select-all">Select All</button>
                    <button id="deselect-all">Deselect All</button>
                </div>
            </div>
        </div>
        <div id="cards"></div>
        <script>
            function saveFormValues() {
                var characterId = document.getElementById("character-id").value;
                if (characterId) {
                    localStorage.setItem("character-id", characterId);
                }

                var apiKey = document.getElementById("api-key").value;
                if (apiKey) {
                    localStorage.setItem("api-key", apiKey);
                }
            }

            async function getCharacterData(characterId) {
                var req = new Request(
                    `https://pathbuilder2e.com/json.php?id=${characterId}`,
                    { method: "GET" }
                );
                var response = await fetch(req);
                return response.json();
            }

            async function getFeatData(featName, featType, apiKey) {
                var headers = new Headers();
                headers.append("Authorization", apiKey);
                var endpoint = featType === "Heritage" ? "heritage" : "feat";

                var req = new Request(
                    `https://api.pathfinder2.fr/v1/pf2/${endpoint}?name=${featName}`,
                    { method: "GET", headers }
                );

                var response = await fetch(req);
                return response.json();
            }

            async function getSpecialData(specialName, apiKey) {
                var headers = new Headers();
                headers.append("Authorization", apiKey);
                var featData;

                var req = new Request(
                    `https://api.pathfinder2.fr/v1/pf2/classFeature?name=${specialName}`,
                    { method: "GET", headers }
                );

                var response = await fetch(req);
                var specialData = await response.json();
                var specialDataResponse = specialData.results.find(
                    (special) => special.name === specialName
                );
                if (specialDataResponse) {
                    return specialDataResponse;
                }

                var req = new Request(
                    `https://api.pathfinder2.fr/v1/pf2/ancestryFeature?name=${specialName}`,
                    { method: "GET", headers }
                );

                var response = await fetch(req);
                var specialData = response.json();
                return specialData;
            }

            async function getSpellData(spellName, apiKey) {
                var headers = new Headers();
                headers.append("Authorization", apiKey);

                var req = new Request(
                    `https://api.pathfinder2.fr/v1/pf2/spell?name=${spellName}`,
                    { method: "GET", headers }
                );

                var response = await fetch(req);
                return response.json();
            }

            function generateFeatCard(featName, featData) {
                if (featData.count === 0) {
                    console.log(`No data found for ${featName} card`);
                    return;
                }

                var feat = featData.results.find(
                    (feat) => feat.name === featName
                );
                console.log(
                    `Generating feat card: ${featName}`,
                    JSON.stringify(feat, null, 2)
                );

                var actionClass = generateActionType(
                    feat.system.actionType,
                    feat.system.actions
                );
                var traits = [
                    feat.system.traits.rarity,
                    ...feat.system.traits.value,
                ].join(", ");

                var description = generateDescription(
                    feat.system.description.value
                );
                var category = feat.system.category
                    ? feat.system.category
                    : "Special";

                var card = appendCard(`<div class="feat-card">
                    <div class="name">
                        <div class="content">
                            ${feat.name}
                            <span class="action"><span class="${actionClass}" /></span>
                        </div>
                    </div>
                    <div class="skill">
                        <div class="content">${feat.type} (${category})</div>
                    </div>
                    <div class="description">
                        <div class="trait">
                            <div class="header">Trait</div>
                            <div class="content">${traits}</div>
                        </div>
                        <hr/>
                        ${description}
                    </div>
                </div>`);
            }

            function generateSpellCard(spellName, spellData) {
                if (spellData.count === 0) {
                    console.log(`No data found for ${spellName} card`);
                    return;
                }

                var spell = spellData.results.find(
                    (spell) => spell.name === spellName
                );
                console.log(
                    `Generating spell card: ${spellName}`,
                    JSON.stringify(spell, null, 2)
                );

                var actionClass = `action-action${
                    spell.system.time.value ? spell.system.time.value : ""
                }`;
                var spellLevel = generateSpellLevel(
                    spell.system.level.value,
                    spell.system.school.value,
                    spell.system.traits.value
                );
                var components = generateSpellComponents(
                    spell.system.components
                );
                var description = generateDescription(
                    spell.system.description.value
                );

                var card = appendCard(`<div class="spell-card">
                    <div class="name">
                        <div class="content">
                            ${spell.name}
                            <span class="action"><span class="${actionClass}" /></span>
                        </div>
                    </div>
                    <div class="spell-level">
                        <div class="content">${spellLevel}</div>
                    </div>
                    <div class="saving-throw">
                        <div class="header">Saving Throw</div>
                        <div class="content">${orDash(
                            spell.system.save.value
                        )}</div>
                    </div>
                    <div class="range">
                        <div class="header">Range</div>
                        <div class="content">${orDash(
                            spell.system.range.value
                        )}</div>
                    </div>
                    <div class="components">
                        <div class="header">Components</div>
                        <div class="content">${orDash(components)}</div>
                    </div>
                    <div class="duration">
                        <div class="header">Duration</div>
                        <div class="content">${orDash(
                            spell.system.duration.value
                        )}</div>
                    </div>
                    <div class="description">${description}</div>
                </div>`);
            }

            function generateSpecialCard(specialName, specialData) {
                console.log(
                    `Generating special card: ${specialName}`,
                    JSON.stringify(specialData, null, 2)
                );

                var special = specialData;
                if (specialData.results) {
                    if (specialData.count === 0) {
                        console.log(`No data found for ${specialName} card`);
                        return;
                    }
                    special = specialData.results.find(
                        (special) => special.name === specialName
                    );
                }

                var actionClass = generateActionType(
                    special.system.actionType,
                    special.system.actions
                );
                var traits = [
                    special.system.traits.rarity,
                    ...special.system.traits.value,
                ].join(", ");

                var description = generateDescription(
                    special.system.description.value
                );
                var category = special.system.category
                    ? special.system.category.replace("feature", "")
                    : "Special";

                var card = appendCard(`<div class="feat-card">
                    <div class="name">
                        <div class="content">
                            ${special.name}
                            <span class="action"><span class="${actionClass}" /></span>
                        </div>
                    </div>
                    <div class="skill">
                        <div class="content">${special.type} (${category})</div>
                    </div>
                    <div class="description">
                        <div class="trait">
                            <div class="header">Trait</div>
                            <div class="content">${traits}</div>
                        </div>
                        <hr/>
                        ${description}
                    </div>
                </div>`);
            }

            function generateActionType(actionType, actions) {
                if (actionType) {
                    return `action-${actionType.value}${
                        actions.value ? actions.value : ""
                    }`;
                }
            }
            function generateDescription(description) {
                return `${description
                    .replaceAll(/@UUID\[.*\]\{(.*)\}/g, "$1")
                    .replaceAll(/\[\[\/r \(\(.*\).*\).*\[.*\]\]\]\{.*\}/g, "")
                    .replaceAll(/\[\[\/r (.*)\[(.*)\]\]\]/g, "$1 $2")}`;
            }

            function generateSpellLevel(level, school, traits) {
                if (traits.includes("cantrip")) {
                    return `${school} Cantrip`;
                }
                switch (level) {
                    case 1:
                        return `${level}st-level ${school}`;
                    case 2:
                        return `${level}nd-level ${school}`;
                    case 3:
                        return `${level}rd-level ${school}`;
                    default:
                        return `${level}th-level ${school}`;
                }
            }

            function generateSpellComponents(components) {
                return [
                    ...(components.verbal ? ["V"] : []),
                    ...(components.somatic ? ["S"] : []),
                    ...(components.material ? ["M"] : []),
                    ...(components.focus ? ["focus"] : []),
                ].join(", ");
            }

            function orDash(val) {
                return val ? val : `&mdash;`;
            }

            function appendCard(card) {
                var element = document.createElement("div");
                element.classList.add("card-wrapper");
                element.innerHTML = card;
                element.addEventListener("click", (_) => {
                    if (element.classList.contains("no-print")) {
                        element.classList.remove("no-print");
                    } else {
                        element.classList.add("no-print");
                    }
                });
                document.getElementById("cards").appendChild(element);

                reorderCards();
            }

            function reorderCards() {
                var deck = document.getElementById("cards");
                var cards = [...deck.children];

                cards.sort((a, b) => {
                    a = a.querySelectorAll(".name .content")[0].innerHTML;
                    b = b.querySelectorAll(".name .content")[0].innerHTML;
                    return a > b;
                });

                var addedCardNames = [];
                cards.forEach((card) => {
                    var thisCard =
                        card.querySelector(".name .content").innerHTML;

                    if (addedCardNames.indexOf(thisCard) !== -1) {
                        console.log(`Duplicate card ${thisCard.trim()} found`);
                        deck.removeChild(card);
                    } else {
                        addedCardNames.push(thisCard);
                        deck.appendChild(card);
                    }
                });
            }

            async function createCards(characterId, apiKey) {
                console.log("Fetching character data");

                var character = await getCharacterData(characterId);
                console.log(
                    "Character fetched",
                    JSON.stringify(character, null, 2)
                );

                var feats = character.build.feats.map((feat) => {
                    return { name: feat[0], type: feat[2] };
                });

                new Set(feats).forEach(async (feat) => {
                    console.log(`Fetching feat data for ${feat.name}`);
                    var featData = await getFeatData(
                        feat.name,
                        feat.type,
                        apiKey
                    );
                    generateFeatCard(feat.name, featData);
                });

                var spellNames = character.build.spellCasters
                    .map((spellCasters) =>
                        spellCasters.spells.map((spells) => spells.list).flat()
                    )
                    .flat();

                new Set(spellNames).forEach(async (spellName) => {
                    console.log(`Fetching spell data for ${spellName}`);
                    var spellData = await getSpellData(spellName, apiKey);
                    generateSpellCard(spellName, spellData);
                });

                new Set(character.build.specials).forEach(
                    async (specialName) => {
                        console.log(`Fetching special data for ${specialName}`);
                        var specialData = await getSpecialData(
                            specialName,
                            apiKey
                        );
                        generateSpecialCard(specialName, specialData);
                    }
                );
            }

            document
                .getElementById("fetch-data")
                .addEventListener("click", async (_) => {
                    saveFormValues();
                    var characterId =
                        document.getElementById("character-id").value;
                    var apiKey = document.getElementById("api-key").value;
                    createCards(characterId, apiKey);
                });

            document
                .getElementById("feat-picker")
                .addEventListener("change", (e) => {
                    var className = e.target.value;
                    Array.from(
                        document.getElementsByClassName("feat-card")
                    ).forEach(function (element) {
                        element.className = "feat-card " + className;
                    });
                });

            document
                .getElementById("spell-picker")
                .addEventListener("change", (e) => {
                    var className = e.target.value;
                    Array.from(
                        document.getElementsByClassName("spell-card")
                    ).forEach(function (element) {
                        element.className = "spell-card " + className;
                    });
                });

            document
                .getElementById("select-all")
                .addEventListener("click", (_) => {
                    document
                        .querySelectorAll(".card-wrapper")
                        .forEach((element) =>
                            element.classList.remove("no-print")
                        );
                });

            document
                .getElementById("deselect-all")
                .addEventListener("click", (_) => {
                    document
                        .querySelectorAll(".card-wrapper")
                        .forEach((element) =>
                            element.classList.add("no-print")
                        );
                });

            (() => {
                var characterId = localStorage.getItem("character-id");
                if (characterId) {
                    document.getElementById("character-id").value = characterId;
                }
                var apiKey = localStorage.getItem("api-key");
                if (apiKey) {
                    document.getElementById("api-key").value = apiKey;
                }
            })();
        </script>
    </body>
</html>
